<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>js | 子舒的博客</title><meta name=keywords content><meta name=description content="子舒的博客，记录生活"><meta name=author content="子舒"><link rel=canonical href=/tags/js/><link crossorigin=anonymous href=/assets/css/stylesheet.5ea1a2f851c645871793276dce298322e6dbf894e6328ec3a0b36446942b7f71.css integrity="sha256-XqGi+FHGRYcXkydtzimDIubb+JTmMo7DoLNkRpQrf3E=" rel="preload stylesheet" as=style><link rel=icon href=https://img.zburu.com/favicon.ico><link rel=mask-icon href=/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/tags/js/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="js"><meta property="og:description" content="子舒的博客，记录生活"><meta property="og:type" content="website"><meta property="og:url" content="/tags/js/"><meta property="og:image" content="/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="js"><meta name=twitter:description content="子舒的博客，记录生活"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=/ accesskey=h title="子舒的博客 (Alt + H)">子舒的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/categories/ title=categories><span>categories</span></a></li><li><a href=/message/ title=message><span>message</span></a></li><li><a href=/lab/ title=lab><span>lab</span></a></li><li><a href=/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>js
<a href=/tags/js/index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>hugo纯静态编写一个字数统计脚本</h2></header><div class=entry-content><p>早上起来的时候看到微信群中有博友分享自己的建站时间，聊着聊着说到总字数上面，这时我才发现我的网站没有统计的地方，索性就自己写一个吧，因为是静态博客，所以不涉及后端、服务器等，只用前端的方式来解决。
这里需要借助我之前的一篇文章，《用原生js给网站写个搜索功能》，里面有提到如何生成一个文章列表json文件，这里我们会用到这个文件 index.json。
写一个ajax方法，让浏览器遍历每个页面。
$(document).ready(function () { $.ajax({ url: '/index.json', type: 'get', dataType: 'json', success: function (data) { const pageUrls = data; const totalNum = pageUrls.length; $('#totalNum').html(totalNum); let totalWords = 0; pageUrls.forEach(urlObj => { $.get(urlObj.permalink, function(data) { const content = data.replace(/(&lt;([^>]+)>)/gi, " ").replace(/[^\w\s]/gi, " "); const words = content.split(" "); const wordCount = words.filter(word => word !== "").length; totalWords += wordCount; $('#totalWords').html(totalWords); }); }); }, error: function () { console.log('error') } }) }); 我是将信息放在我的 关于 页面下。...</p></div><footer class=entry-footer><span title='2023-05-13 00:00:00 +0000 UTC'>May 13, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;90 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to hugo纯静态编写一个字数统计脚本" href=/blog/194.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>用原生js给网站写个搜索功能</h2></header><div class=entry-content><p>本文也算是一篇教程，可以给 hugo 网站加个搜索功能，并且实现热更新，体验感更好。
如果是其他程序，只需要按照特定的模板生成以下格式的文件即可，主要代码从 第2部分 开始，第一章节写的是如何用 hugo 输出文章列表 json 文件。
title 是文章标题，permalink 是文章链接。
[{ "permalink": "", "title": "" }, { "permalink": "", "title": "" }] 1. hugo模板生成文章列表json文件 在 layouts 文件夹下新建 index.json 文件，模板内容如下：
其中第2行最后面的 "blog" 是你文章文件夹的名称。大部分是 posts 等等，这里是我个人的名称。
{{- $.Scratch.Set "posts" slice -}} {{- range where .Site.RegularPages "Type" "blog" -}} {{- $.Scratch.Add "posts" (dict "title" .Title "permalink" .Permalink) -}} {{- end -}} {{- $.Scratch.Get "posts" | jsonify -}} 按照这个模板，hugo本地预览可以打开 http://localhost:1313/index.json 查看，如果输出了一些数据如下图，说明你成功了。...</p></div><footer class=entry-footer><span title='2023-03-17 00:00:00 +0000 UTC'>March 17, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;317 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to 用原生js给网站写个搜索功能" href=/blog/189.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>利用 memos 生成的在线动态列表</h2></header><div class=entry-content><p>memos 是一个具有知识管理和社交功能的开源自托管备忘录中心。
Github地址：https://github.com/usememos/memos
可以用它本身提供的 api，然后结合静态博客，做成一个在线的动态列表，类似于朋友圈功能。
接口 url 有固定的格式，openId 是每个用户自动生成的。
其次我又写了两个方法，一个是时间戳转成正常时间格式，一个是利用正则删去内容中多余的标签。
将下面代码复制到你想显示的页面编辑，只需修改 openId，提供了一个基础的样式，如果有其他优化方案，欢迎指出。
由于接口中带了用户密钥，建议完成代码后将js加密再引入，不然可能会有一定的安全风险。
推荐网址: https://tool.lu/js/
&lt;!-- 结构和css --> &lt;div class="sslist">&lt;/div> &lt;style> .sslist-item { padding: 10px 10px 20px; margin-bottom: 20px; border-radius: 2px; background: #f3f3f3; box-shadow: 1px 2px 4px rgba(0, 0, 0, .2); transition: all 0.2s linear; animation: up 1s forwards; transform: translateY(20px); opacity: 0; } @keyframes up { 0% { transform: translateY(20px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } } ....</p></div><footer class=entry-footer><span title='2023-01-09 00:00:00 +0000 UTC'>January 9, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;262 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to 利用 memos 生成的在线动态列表" href=/blog/181.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>分享一个页面点击特效</h2></header><div class=entry-content><p>点击页面时可以弹出随机颜色小心心，目前我的网站就使用了这个特效。
直接将下面的代码复制到引入的 js 文件中即可，不用进行其他配置。
!function(e,t,a){function n(){c(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o(),r()}function r(){for(var e=0;e&lt;d.length;e++)d[e].alpha&lt;=0?(t.body.removeChild(d[e].el),d.splice(e,1)):(d[e].y--,d[e].scale+=.004,d[e].alpha-=.013,d[e].el.style.cssText="left:"+d[e].x+"px;top:"+d[e].y+"px;opacity:"+d[e].alpha+";transform:scale("+d[e].scale+","+d[e].scale+") rotate(45deg);background:"+d[e].color+";z-index:99999");requestAnimationFrame(r)}function o(){var t="function"==typeof e.onclick&&amp;e.onclick;e.onclick=function(e){t&&amp;t(),i(e)}}function i(e){var a=t.createElement("div");a.className="heart",d.push({el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()}),t.body.appendChild(a)}function c(e){var a=t.createElement("style");a.type="text/css";try{a.appendChild(t.createTextNode(e))}catch(t){a.styleSheet.cssText=e}t.getElementsByTagName("head")[0].appendChild(a)}function s(){return"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}var d=[];e.requestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)}}(),n()}(window,document);</p></div><footer class=entry-footer><span title='2023-01-06 00:00:00 +0000 UTC'>January 6, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;36 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to 分享一个页面点击特效" href=/blog/180.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>js中 [ ]+{ } 和 { }+[ ] 的区别</h2></header><div class=entry-content><p>[ ]+{ }：一个数组加一个对象。
加法会进行隐式类型转换，规则是调用其valueOf()或toString()以取得一个非对象的值(primitive value)。
如果两个值中的任何一个是字符串，则进行字符串串接，否则进行数字加法。[ ] 和 { } 的 valueOf() 都返回对象自身，所以都会调用 toString()，最后的结果是字符串串接。
[ ].toString()返回空字符串，({ }).toString()返回 “[object Object]"，最后的结果就是 “[object Object]"。
{ }+[ ]：看上去应该和上面一样。
但是{ }除了表示一个对象之外，也可以表示一个空的bock。在 [ ] + { }中，[ ]被解析为数组，因此后续的+被解析为加法运算符，而{ }就解析为对象。
但在{ } + [ ]中，{ }被解析为空的bock，随后的+被解析为正号运算符。即实际上成了：{∥empty block}+[ ]，即对一个空数组执行正号运算，实际上就是把数组转型为数字。首先调用.valueOf()，返回数组自身，不是primitive value,因此继续调用 [ ].toString()，返回空字符串。空字符串转型为数字，返回0，即最后的结果。</p></div><footer class=entry-footer><span title='2022-11-15 00:00:00 +0000 UTC'>November 15, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;44 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to js中 [ ]+{ } 和 { }+[ ] 的区别" href=/blog/175.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>localStorage 的相关运用</h2></header><div class=entry-content><p>localStorage 是浏览器自带的一个属性，只读的localStorage 属性允许你访问一个Document 源（origin）的对象 Storage；存储的数据将保存在浏览器会话中。localStorage 类似 sessionStorage，但其区别在于：存储在 localStorage 的数据可以长期保留；而当页面会话结束——也就是说，当页面被关闭时，存储在 sessionStorage 的数据会被清除。
应注意，无论数据存储在 localStorage 还是 sessionStorage ，它们都特定于页面的协议。
另外，localStorage 中的键值对总是以字符串的形式存储。 (需要注意，和 js 对象相比，键值对总是以字符串的形式存储意味着数值类型会自动转化为字符串类型).
localStorage 的使用也非常简单，分为存入和读取，可以将其绑定在事件方法中。
// 存入 const arr= 100; localStorage.setItem("key", JSON.stringify(arr)); // 读取 const arr = JSON.parse(localStorage.getItem("key")); 这里 "key" 指的是存到浏览器中的参数名，arr 则是参数值。
localStorage.setItem("key", JSON.stringify(arr)); 这个方法就是将数组arr存到了浏览器的localStorage 中，它的参数名叫 key const arr = JSON.parse(localStorage.getItem("key")); 就是读取浏览器中参数名为 key 的参数值。 比如静态保存某个设置参数，可以将其写入数组中，然后通过 localStorage 存储，原本刷新就会显示默认设置，现在可以在每次刷新的适合读取存入的参数。
在一些场景下非常好用，比如开发一个油猴脚本等等。
清除 localStorage，分为清除所以的存储值和清除某个特定的 key。
// 清除本地存储中的所有值 localStorage.clear(); // 本地存储中删除特定项 localStorage.removeItem(key);</p></div><footer class=entry-footer><span title='2022-10-20 00:00:00 +0000 UTC'>October 20, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;65 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to localStorage 的相关运用" href=/blog/171.html/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>将数组中多个对象的同名属性值取出合并成新数组</h2></header><div class=entry-content><p>业务中需求的方法，接口返回一个数组，里面包含了大量的对象，具有同名的属性名，比较常见。但是需要将其中参数为name的属性值全部取出，合并成数组。
const num = [ { id: 1, name: 'abc', }, { id: 2, name: 'xyz', } ] function getFields(arrnum, field) { const resnum = []; for (let i = 0; i &lt; arrnum.length; ++i) resnum.push(arrnum[i][field]); return resnum; } const result = getFields(num, "name"); console.log(result); // ['abc', 'xyz'] console.log(result.join(' ')); // "abc xyz"</p></div><footer class=entry-footer><span title='2022-09-26 00:00:00 +0000 UTC'>September 26, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;53 words&nbsp;·&nbsp;子舒</footer><a class=entry-link aria-label="post link to 将数组中多个对象的同名属性值取出合并成新数组" href=/blog/168.html/></a></article><footer class=page-footer><nav class=pagination><a class=next href=/tags/js/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=/>子舒的博客</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>